<?php

require_once __DIR__ . '/../vendor/autoload.php';

use Weiming\Libs\Utils;

$parterNo = 'SYF201805030857';
$parterKey = '{"md5Key":"CE44961CF4ACE86A7B56A261B4A35246","pubKey":"MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCZc+j2CSpq1VtyCj7GbfKhyTHVZRuJES2N/z7SM2ksgLhRRRfnTu7fkNWR/gm7qFyDXmcQekYiofCd1iXS1WOw9wlUPBk7NevN/Xp9ZMnxXW6CiIqrO89253dglAzsNuyY5hGsnijMT5DwDipcdAutgFjfXUiuYWHFtkZFTjhRMQIDAQAB","priKey":"MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBAIL6D9Hp8S8zrnSoq42/XFi4jxrfSUDTJ8vZ4QuwnkywlhNOmVBKJMRL1GvxLXJBEddxnKRDPR2OlV8cdfYrj1ULRaNkNTvfBM9LUs2y4dFUa/R4MFnmD/ZG0PRWL1g+RRsiPTVzBPY0V5oIZ/VQx+nrIrTRBt0VNmumy68FQQeHAgMBAAECgYBOG6hRi8zsVErGgUwFdUgyFKYq5Vu/D+2csOt3WDWfEHP/QZFGg2DXu00LrkFm8I0eST+b6glJVh2YIdXrH2ES/yngRDh0h8ds4g9zWdLSnIPalFPpkx/SxfN/LUdIBZF24mkDEgc4TgZk5s/ZSiGs/Ju2nwQ8Zn8rUGNKrARDoQJBANCfuKSjdEn0jtr6v0Peea16giL3YV8Eq+OnEIRiF6RDatmTFIuEsa2/7qZiGK4wlziH+XXGXskuwyaZlUkb9FcCQQCguFpWFLZi9iolPNTKWO42QfXpT9uTV7tM7+nhQdSGX2ERJxHaDTmZNcIT7vmUlks8NKVlQUUkW8AcRosOqghRAkBKJgqdUY8aXfaMNATY3XDHzLwGK4CLIgDp584CD08xzdhjPlhWAjKYe5gZwNHez1xf9kwepQO5Y4pu5LVfh7T/AkBHaQICY1uSZuvc9cVaTt8wzmf0DV5zfjSjf6m8Q2KpfbGETIa7Css/zsn3z2OnaIvvKTkf3ztYZ0fZiGJ61oOxAkEAp9KrBZeCGNKtiNIhCYGBg95eZ5QcsWJSJlPxD2PCOAT5iYxJFAtWNpQuitE04v5Jo/f5I2emHwq42VjajdEuVA=="}';

$orderNo = Utils::getOrderId(date('YmdHis'));
// $orderNo = date('YmdHis') .rand(10000, 99999);

var_dump(Weiming\Libs\Payments\Shanyi::getInstance(['parterNo' => $parterNo, 'parterKey' => $parterKey, 'callbackUrl' => 'http://47.90.98.83:9898/callback', 'notifyUrl' => 'http://47.90.98.83:9898/notify'])->signature('ZFB_WAP', 500, $orderNo)->payment());

// callback

// $callbackJson = '{"encryptData":"AB77AA822FE1AD6816FBC4CA6A7A4EEB8B7A41D73E0463A4F5FB0998B0CA4F17120A428F06B77563E04E61E211CDC2A486725DE1BBC7E7A24D3427C2AF2053B1E19D25779437D02448647CB29CEC19803321AA2159AB496AB14627FB8C8092EF7E4FB336E1A18D1FB7C3E164D9BDB99631D757178028250C445FC8434C1AD4CA4FF106E37138E06FCDE435C094ED1A1267135E368AFD6C584E9C88D67D44AC57754E2C318AB3ECCB962864229A8599B90D30CC3D56FBE9D77A2F6DA9AED1D351DB7872ABBA83ECBA422079C69769577E51F3E0CD2D6BA8459A503E931B70EFA815EF39C0DFB7A89ED8C2F5F2EFB95CA06001119BC7590D9A210626B8537CA12CEA328279EFEFD13D5878394F03D603002836B0B5AFA321F4A53C9483EF69457BDB8DC0D72B5A36954E84B14E3BE88C0CA83D3A35FAC96863B3E7A5A339C9A75A0637396E8BE8E0B5C1FFEBFFF2FD92884A087711220D055CF89386870F950ADB1ED69F71F6E4EEE9FF1F5CCEBBF30E4A15A9203D9E0F3C9B93670C6677E022471DE879FBAEB3354CEF6374E1169F1310B1C07622932A81B24613B99011F2CE712F04965B8E6DCF54E463E91D4B77F171","sign":"QaMe8gF1Zd1Y+wOHqZjFST9pHwqwNyxvTPxjEBDitC0qZv6ZH3jQE9qktQ+7MbtCow8x0B3xJYdUgXY1PUyNs4QcYygUhbprEkyGzG34W9xZpmh/6iGqGLqFKLYIbjjuEWKUl3c1DsxTv8NgLFjUbaNxo0Q1JjhFeKm06LKzLzdaqKJxgxvTYJ05CXRGfAhmLuTjFd0vVI4CfFnz1Ondamy6NfdIXurOlz09wC3uDtT/ZzbYZ0A2N5+6HnbXVnHhth8mJYfo1d0o6XEULqTAaHs8iqn8KQ2nngBiC9GB0ffBsSPTdXn7nJNXrN/Hlzyb5Ws060vaFt4NKiCWLfhckA=="}';

// $datas = json_decode($callbackJson, true);

// var_dump(Weiming\Libs\Payments\Shanyi::getInstance(['parterNo' => $parterNo, 'parterKey' => $parterKey, 'callbackUrl' => 'http://47.90.98.83:9898', 'notifyUrl' => ''])->callbackVerifySign(json_decode($callbackJson, true)));


// echo Utils::decryptAES($datas['encryptData'], 'e6442hXl525nls7V');
