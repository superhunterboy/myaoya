app.controller("uploadImg",["$scope","$rootScope","http","ngDialog","Tip",function(a,n,t,o,i){n.patchName="uploadImg",a.img={},a.setting=[!1,!1,!1],a.companyInfo={},t.get("/admin/getCompaniesByCurrentUser",{},function(t){if(t.data){for(var o=0;o<t.data.length;o++)a.companyInfo[t.data[o].id]=t.data[o];a.companyList=n.userInfo.company_ids.split(","),a.nowCompany=a.companyList[0]}}),t.get("/admin/getPictures",{},function(n){for(var t=0;t<n.data.length;t++)a.img[n.data[t].company_id]||(a.img[n.data[t].company_id]=[]),1==n.data[t].type?a.img[n.data[t].company_id].unshift(n.data[t]):a.img[n.data[t].company_id].push(n.data[t]);for(k in a.img){a.temp=angular.copy(a.img[k]);break}}),a.changeCompany=function(){a.setting=[!1,!1,!1],a.temp=angular.copy(a.img[a.nowCompany])},a.save=function(n){a.loading||(a.loading=!0,t.put("/admin/updatePicture/"+a.temp[n].id,a.temp[n],function(t){a.loading=!1,0==t.status?(a.setting[n]=!1,a.img[a.nowCompany][n]=angular.copy(a.temp[n]),i.success("保存成功！")):i.error(t.msg)}))},a.cancel=function(n){a.setting[n]=!1,a.temp[n]=angular.copy(a.img[a.nowCompany][n])},a.edit=function(n){a.setting[n]=!0}}]);